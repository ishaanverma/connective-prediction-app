<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Connective Prediction</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.2/css/bulma.min.css">
        <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    </head>
    <body>
        <section class="section">
            <div class="columns">
                <div class="container column">
                    <h1 class="title">Discourse Connective Prediction</h1>
                    <p class="subtitle">Type two sentences to predict a connective</p>
                    <a id="example1" class="button">Example 1</a>
                    <button id="example2" class="button">Example 2</button>
                    <button id="example3" class="button">Example 3</button>
                    
                    <form id="connectivePredict" action={{ url_for('predict') }} method="get">
                        <br/>
                        <div class="field">
                            <label class="label">Sentence 1</label>
                            <div class="control">
                                <textarea name="sentence1" id="sentence1" class="textarea" placeholder="Enter Sentence 1"></textarea>
                            </div>
                        </div>
                        <br/>
                        <div class="field">
                            <label class="label">Sentence 2</label>
                            <div class="control">
                                <textarea name="sentence2" id="sentence2" class="textarea" placeholder="Enter Sentence 2"></textarea>
                            </div>
                        </div>
                        <div class="field">
                            <div class="control">
                                <button id="submitForm" type="submit" value="Predict" class="button is-primary">Predict</button>
                            </div>
                        </div>
                        <br/>
                    </form>
                </div>
                <div class="container column">
                    <div id="predictionPanels" class="panel">
                        <div class="panel-heading">
                            Top 5 Predictions
                        </div>
                        <div class="panel-block" style="display: flex; justify-content: space-between;">
                        <p>&nbsp;</p>
                          <span id="value"></span>
                        </div>
                        <div class="panel-block" style="display: flex; justify-content: space-between;">
                        &nbsp;
                          <span id="value"></span>
                        </div>
                        <div class="panel-block" style="display: flex; justify-content: space-between;">
                        &nbsp;
                          <span id="value"></span>
                        </div>
                        <div class="panel-block" style="display: flex; justify-content: space-between;">
                        &nbsp;
                          <span id="value"></span>
                        </div>
                        <div class="panel-block" style="display: flex; justify-content: space-between;">
                        &nbsp;
                          <span id="value"></span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script>

            $('#example1').click(function()  {
                console.log("hello");
                $("#sentence1").val("If the question was answered correctly, the team would receive the next clue.");
                $("#sentence2").val("The chosen team member would have to try again.");
            });

            $('#example2').click(function()  {
                console.log("hello");
                $("#sentence1").val("Lee then continued on to Boston, arriving on 25th June.");
                $("#sentence2").val("The ranks of General Washingtonâ€™s Navy were being thinned by captures.");
            });

            $('#example3').click(function()  {
                console.log("hello");
                $("#sentence1").val("In December 2010 and January 2011, members of the NSW Legislative Council attempted to hold an inquiry into the sale.");
                $("#sentence2").val("Directors of the companies involved refused to attend hearings after the Parliament of New South Wales was prorogued with the effect that directors would not have the protection of parliamentary privilege while giving evidence.");
            });

            function showPredictedConnectives(data, status, xhr) {
                results = data["predictions"];
                values = data["values"];
                console.log(values);
                $('#predictionPanels > .panel-block').each(function(index)  {
                    $(this).html(`<span>${results[index]}</span> <span class="panel-icon">${values[index].toFixed(3)} &nbsp;   </span>`);
                    
                });
                
            }

            $('#connectivePredict').submit(function(event)  {
                event.preventDefault();
                var form = $(this);
                var url = form.attr('action');

                $.get({
                    url: url,
                    data: form.serialize(),
                    beforeSend: function() { $('#submitForm').addClass("is-loading"); },
                    success: showPredictedConnectives,
                    complete: function() { $('#submitForm').removeClass("is-loading"); },
                });
            })
        </script>
    </body>
</html>
